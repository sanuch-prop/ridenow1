<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>–ê–∫—Ç—É–∞–ª—å–Ω–∞—è ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Ä¢ RideNow</title>
<style>
  :root{
    --ink:#eaf2ff; --muted:#a6b5cc; --stroke:rgba(255,255,255,.18);
    --glass-1:rgba(14,21,26,.55); --glass-2:rgba(14,21,26,.35);
    --g1:#ffb668; --g2:#9de9d7;
    --gutter:16px; --card-gap-bottom:12px; --nav-h:92px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    color:var(--ink);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:
      linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.55) 35%, rgba(0,0,0,.45) 60%, rgba(0,0,0,.55)),
      url("image.png") center/cover no-repeat fixed;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    padding:var(--gutter);
    padding-bottom:calc(var(--gutter) + env(safe-area-inset-bottom));
    display:flex; flex-direction:column; overflow:hidden;
  }

  /* —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–æ—á–∫–∞; –µ—Å—Ç—å –∑–∞–∑–æ—Ä –Ω–∞–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π */
  main.card{
    width:min(760px, calc(100vw - var(--gutter)*2));
    margin:0 auto;
    border-radius:22px; border:1px solid var(--stroke);
    background:linear-gradient(180deg,var(--glass-1),var(--glass-2));
    box-shadow:0 30px 80px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.22);
    backdrop-filter: blur(16px) saturate(140%);
    max-height:calc(100dvh - var(--nav-h) - var(--card-gap-bottom) - env(safe-area-inset-bottom));
    overflow:auto; -webkit-overflow-scrolling:touch;
  }
  .inner{ padding:16px 16px 18px }

  .brand{font-weight:900;display:flex;gap:8px;align-items:center;opacity:.95}
  .brand .dot{width:8px;height:8px;border-radius:50%;background:#58e0ff}
  h1{margin:8px 0 12px;font-size:26px;letter-spacing:.2px}

  /* —à–∞–ø–∫–∞ */
  .head{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
    padding:12px;border:1px solid var(--stroke);border-radius:16px;
    background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));}
  .route{font-weight:900;font-size:22px;line-height:1.25}
  .row{display:flex;flex-wrap:wrap;gap:12px;color:var(--muted);font-weight:700}
  .row span{display:flex;align-items:center;gap:6px}
  .price-badge{white-space:nowrap;font-weight:900;color:#072e12;
    background:linear-gradient(90deg,#b8ff9c,#7dffcf);padding:8px 12px;border-radius:14px;align-self:flex-start}

  /* –±–ª–æ–∫ –æ–∂–∏–¥–∞–Ω–∏—è */
  .notice{
    margin-top:12px; padding:12px; border-radius:14px;
    border:1px solid rgba(255,213,155,.35);
    background:linear-gradient(180deg, rgba(255,213,155,.12), rgba(255,213,155,.08));
  }
  .notice-title{font-weight:900; color:#ffd59b; display:flex; gap:8px; align-items:center}
  .notice-text{color:#ffdeb4; font-weight:700; opacity:.95; margin-top:4px}
  .meter{height:8px;border-radius:999px;background:rgba(255,213,155,.22);overflow:hidden;margin-top:10px}
  .meter > i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--g1),var(--g2))}
  .timeleft{font-weight:900}
  .pending-actions{display:flex;gap:10px;margin-top:12px}
  .btn{height:44px;border-radius:12px;border:1px solid var(--stroke);
    background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
    color:var(--ink);font-weight:800;padding:0 12px;text-decoration:none;display:inline-grid;place-items:center}

  /* –≤–∞—É—á–µ—Ä 25 ‚Ç¥ */
  .voucher{
    display:none; margin-top:10px; padding:10px 12px;
    border-radius:12px; border:0;
    background:linear-gradient(90deg,#b8ff9c,#7dffcf); color:#063d17;
    font-weight:900;
  }

  /* –æ–±—â–∏–µ –±–ª–æ–∫–∏ */
  .grid{display:grid;gap:12px;margin-top:12px}
  .block{padding:12px;border-radius:16px;border:1px solid var(--stroke);
    background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));}

  /* –∫–∞—Ä—Ç–∞ */
  .map-wrap{border:1px solid var(--stroke);border-radius:14px;overflow:hidden;margin-top:10px}
  .map-wrap iframe{width:100%;height:220px;border:0;display:block}
  .map-actions{display:flex;justify-content:flex-end;margin-top:8px}

  /* —É–¥–æ–±—Å—Ç–≤–∞ */
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{padding:6px 10px;border-radius:999px;border:1px solid var(--stroke);
    background:linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.08));
    font-size:14px;font-weight:700}

  /* —Ñ–æ—Ç–æ */
  .photos{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
  .ph{height:86px;border-radius:12px;overflow:hidden;background:#222;display:grid;place-items:center}
  .ph img{width:100%;height:100%;object-fit:cover}
  @media (max-width:380px){ .ph{height:76px} }

  /* –≤–æ–¥–∏—Ç–µ–ª—å */
  .driver{display:flex;gap:12px;align-items:center}
  .ava{width:56px;height:56px;border-radius:50%;overflow:hidden;background:#666;flex-shrink:0}
  .ava img{width:100%;height:100%;object-fit:cover}
  .d-info{flex:1}
  .name{display:flex;align-items:center;gap:6px;font-weight:900}
  .ver{font-size:12px;padding:2px 6px;border-radius:8px;background:linear-gradient(90deg,#9de9d7,#ffb668);color:#0b0f12;font-weight:900}
  .stars{color:#ffd479;font-size:14px}
  .car{color:#cfe3ff}

  /* –ø–∞—Å—Å–∞–∂–∏—Ä—ã */
  .faces{display:flex;gap:8px}
  .face{width:40px;height:40px;border-radius:50%;overflow:hidden;border:2px dashed rgba(255,255,255,.35);
    display:grid;place-items:center;background:#222;color:#9fb0c9;font-weight:900}
  .face img{width:100%;height:100%;object-fit:cover}

  /* –Ω–∏–∑ ‚Äî –∫–∞–∫ –≤–µ–∑–¥–µ: —Å–ª–µ–≤–∞ –ü—Ä–æ—Ñ–∏–ª—å, —Å–ø—Ä–∞–≤–∞ –ü–æ–∏—Å–∫ */
  .bottom-shell{position:fixed;left:0;right:0;bottom:0;z-index:1001;
    padding:0 env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
  .bottom-bar{display:flex;justify-content:space-around;background:var(--glass-2);
    border-radius:20px 20px 0 0;padding:8px;backdrop-filter:blur(12px)}
  .bn-tab{flex:1;text-align:center;color:var(--ink);font-size:12px;text-decoration:none;padding:6px 0}
  .bn-tab .ico{font-size:18px;display:block}
  .bn-tab.active{color:var(--g1)}
</style>
</head>
<body>
  <main class="card" id="card">
    <div class="inner">
      <div class="brand"><span class="dot"></span><span>RideNow</span></div>
      <h1>–ê–∫—Ç—É–∞–ª—å–Ω–∞—è</h1>

      <!-- –®–∞–ø–∫–∞ -->
      <div class="head">
        <div>
          <div class="route">–ö–∏–µ–≤ ‚Üí –û–¥–µ—Å—Å–∞</div>
          <div class="row" style="margin-top:6px">
            <span>‚è∞ 08:30 ‚Üí 13:15</span>
            <span>üõ£Ô∏è 475 –∫–º</span>
            <span>üßç 3 –º–µ—Å—Ç–∞</span>
            <span>üìÖ 16.09.2025</span>
          </div>
        </div>
        <div class="price-badge">550 ‚Ç¥</div>
      </div>

      <!-- –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
      <section class="notice" id="pendingBox">
        <div class="notice-title" id="noticeTitle">‚è≥ –ù–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞</div>
        <div class="notice-text" id="noticeText">
          –û–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞. –ï—Å–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—å –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç ‚Äî –±—Ä–æ–Ω—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–∏—Ç—Å—è.
        </div>
        <div class="meter"><i id="meterFill" style="width:0%"></i></div>
        <div style="margin-top:6px">–û—Å—Ç–∞–ª–æ—Å—å: <span class="timeleft" id="timeLeft">60:00</span></div>

        <div class="pending-actions">
          <a class="btn" id="searchCta" href="search-passenger.html?from=–ö–∏–µ–≤&to=–û–¥–µ—Å—Å–∞&date=16.09.2025">–ò—Å–∫–∞—Ç—å –¥—Ä—É–≥—É—é</a>
          <button class="btn" id="cancelBooking">–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å</button>
        </div>

        <!-- –ë–∞–Ω–Ω–µ—Ä –ø—Ä–æ 25 ‚Ç¥ -->
        <div class="voucher" id="voucherBox">–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–±–æ—Ä 25 ‚Ç¥ —É–∂–µ –æ–ø–ª–∞—á–µ–Ω ‚Äî —Å–ª–µ–¥—É—é—â–∞—è –±—Ä–æ–Ω—å –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏.</div>
      </section>

      <div class="grid">
        <!-- –ú–∞—Ä—à—Ä—É—Ç –∏ —Ç–æ—á–∫–∏ + –∫–∞—Ä—Ç–∞ -->
        <section class="block" id="route">
          <h3 style="margin:0 0 10px">–ú–∞—Ä—à—Ä—É—Ç –∏ —Ç–æ—á–∫–∏</h3>
          <div class="row">
            <span>üìç –°—Ç–∞—Ä—Ç: –ö–∏–µ–≤, –í—ã–¥—É–±–∏—á–∏</span>
            <span>üìç –§–∏–Ω–∏—à: –û–¥–µ—Å—Å–∞, –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è</span>
            <span>‚õΩ –û—Å—Ç–∞–Ω–æ–≤–∫–∞: –£–º–∞–Ω—å</span>
          </div>
          <div class="map-wrap">
            <iframe loading="lazy"
              src="https://www.google.com/maps?q=Kyiv%20to%20Odesa&output=embed"
              referrerpolicy="no-referrer-when-downgrade" aria-label="–ö–∞—Ä—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞"></iframe>
          </div>
          <div class="map-actions">
            <a class="btn" id="mapOpen" target="_blank" rel="noopener">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</a>
          </div>
        </section>

        <!-- –£–¥–æ–±—Å—Ç–≤–∞ -->
        <section class="block">
          <h3 style="margin:0 0 10px">–£–¥–æ–±—Å—Ç–≤–∞</h3>
          <div class="chips">
            <div class="chip">üéß –ú—É–∑—ã–∫–∞</div>
            <div class="chip">‚ùÑÔ∏è –ö–ª–∏–º–∞—Ç</div>
            <div class="chip">‚ö° –ó–∞—Ä—è–¥–∫–∞</div>
            <div class="chip">üó£Ô∏è –ü–æ–±–æ–ª—Ç–∞–µ–º</div>
            <div class="chip">üö≠ –ù–µ–∫—É—Ä—è—â–∏–π</div>
          </div>
        </section>

        <!-- –§–æ—Ç–æ -->
        <section class="block">
          <h3 style="margin:0 0 10px">–§–æ—Ç–æ</h3>
          <div class="photos">
            <div class="ph"><img src="https://images.unsplash.com/photo-1549924231-f129b911e442?w=400" alt=""></div>
            <div class="ph"><img src="https://images.unsplash.com/photo-1606661125322-1d66f2e7f3a7?w=400" alt=""></div>
            <div class="ph"><img src="https://images.unsplash.com/photo-1619767886558-c2b2e6d6c9f0?w=400" alt=""></div>
            <div class="ph"><img src="https://images.unsplash.com/photo-1617788138017-80ad91f1860d?w=400" alt=""></div>
          </div>
        </section>

        <!-- –í–æ–¥–∏—Ç–µ–ª—å -->
        <section class="block">
          <div class="driver">
            <div class="ava"><img src="https://images.unsplash.com/photo-1599566150163-29194dcaad36?w=200" alt=""></div>
            <div class="d-info">
              <div class="name">–ü–∞–≤–µ–ª <span class="ver">‚úì</span></div>
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
              <div class="car">Toyota Camry ‚Ä¢ –ê–Ü 1234 –ö–ï</div>
            </div>
          </div>
        </section>

        <!-- –ü–∞—Å—Å–∞–∂–∏—Ä—ã -->
        <section class="block">
          <h3 style="margin:0 0 10px">–ü–∞—Å—Å–∞–∂–∏—Ä—ã</h3>
          <div class="faces">
            <div class="face"><img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200" alt=""></div>
            <div class="face"><img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=200" alt=""></div>
            <div class="face">‚Äî</div>
          </div>
        </section>

        <!-- –£—Å–ª–æ–≤–∏—è (–±–µ–∑ –æ–Ω–ª–∞–π–Ω-–æ–ø–ª–∞—Ç—ã) -->
        <section class="block">
          <h3 style="margin:0 0 10px">–£—Å–ª–æ–≤–∏—è –ø–æ–µ–∑–¥–∫–∏</h3>
          <ul style="margin:0; padding-left:18px; color:#cfe3ff">
            <li>–û–ø–ª–∞—Ç–∞ <strong>—Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –≤–æ–¥–∏—Ç–µ–ª—é</strong> –ø—Ä–∏ –ø–æ—Å–∞–¥–∫–µ.</li>
            <li>–û—Ç–º–µ–Ω–∞ ‚Äî –Ω–µ –ø–æ–∑–¥–Ω–µ–µ, —á–µ–º –∑–∞ 1 —á–∞—Å –¥–æ –≤—ã–µ–∑–¥–∞.</li>
          </ul>
        </section>
      </div>
    </div>
  </main>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <nav class="bottom-shell" id="nav" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è">
    <div class="bottom-bar">
      <a class="bn-tab" href="profile-passenger.html"><div class="ico">üë§</div>–ü—Ä–æ—Ñ–∏–ª—å</a>
      <a class="bn-tab" href="wallet.html"><div class="ico">üí≥</div>–ö–æ—à–µ–ª—ë–∫</a>
      <a class="bn-tab active" href="active.html"><div class="ico">üöó</div>–ê–∫—Ç—É–∞–ª—å–Ω–∞—è</a>
      <a class="bn-tab" href="main-passenger.html"><div class="ico">üîç</div>–ü–æ–∏—Å–∫</a>
    </div>
  </nav>

<script>
  // –≤—ã—Å–æ—Ç–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -> CSS var(--nav-h)
  (function setNavHeight(){
    const nav = document.getElementById('nav');
    const apply = ()=> document.documentElement.style.setProperty('--nav-h', (nav?.offsetHeight||92) + 'px');
    apply(); addEventListener('resize', apply);
  })();

  // —Ç–æ—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –≤ –∫–∞—Ä—Ç–∞—Ö
  (function setMapLink(){
    const origin = '50.4015,30.5593'; // –í—ã–¥—É–±–∏—á–∏
    const dest   = '46.4825,30.7233'; // –û–¥–µ—Å—Å–∞
    const url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(dest)}&travelmode=driving`;
    document.getElementById('mapOpen').href = url;
  })();

  // ====== –°–¢–ê–¢–£–° –ò –¢–ê–ô–ú–ï–† –û–ñ–ò–î–ê–ù–ò–Ø ======
  const qs = new URLSearchParams(location.search);
  const TRIP_ID = qs.get('tripId') || 'kyiv-odesa';
  const STORE_KEY = `rn:booking:${TRIP_ID}`;
  const DEADLINE_MS = 60 * 60 * 1000; // 1 —á–∞—Å
  const PAID_KEY = `rn:payment:${TRIP_ID}`;       // –≥–¥–µ pay.html –ø–æ–º–µ—á–∞–µ—Ç "1"
  const VOUCHER_KEY = 'rn:svcfee:voucher';        // –ø–µ—Ä–µ–Ω–æ—Å 25 ‚Ç¥ –Ω–∞ —Å–ª–µ–¥. –±—Ä–æ–Ω—å

  // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
  let state = {};
  try{
    state = JSON.parse(localStorage.getItem(STORE_KEY) || '{}');
  }catch{ state = {}; }
  if (!state.createdAt){
    // –º–∏–≥—Ä–∞—Ü–∏—è –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –∫–ª—é—á–∞, –µ—Å–ª–∏ –µ—Å—Ç—å
    try{
      const legacy = JSON.parse(localStorage.getItem('activeBooking')||'{}');
      if (legacy?.createdAt) state.createdAt = legacy.createdAt;
    }catch{}
  }
  if (!state.createdAt){
    state.createdAt = Date.now();
    state.status = 'pending';
  }
  localStorage.setItem(STORE_KEY, JSON.stringify(state));

  // –¥–µ–º–æ-–∞–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: ?confirmIn=10 (—Å–µ–∫)
  const mockConfirm = Number(qs.get('confirmIn') || 0);
  if (mockConfirm > 0) setTimeout(()=> updateStatus('confirmed'), mockConfirm*1000);

  const timeLeftEl  = document.getElementById('timeLeft');
  const meterFill   = document.getElementById('meterFill');
  const noticeTitle = document.getElementById('noticeTitle');
  const noticeText  = document.getElementById('noticeText');
  const searchCta   = document.getElementById('searchCta');
  const voucherBox  = document.getElementById('voucherBox');

  // –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–Ω–Ω–µ—Ä, –µ—Å–ª–∏ –≤–∞—É—á–µ—Ä —É–∂–µ –µ—Å—Ç—å
  function renderVoucherBanner(){
    try{
      const v = JSON.parse(localStorage.getItem(VOUCHER_KEY)||'null');
      if (v && !v.used && Number(v.amount) >= 25){
        voucherBox.style.display = 'block';
      } else {
        voucherBox.style.display = 'none';
      }
    }catch{ voucherBox.style.display = 'none'; }
  }
  renderVoucherBanner();

  // –∑–∞–ø–∏—Å–∞—Ç—å –≤–∞—É—á–µ—Ä 25 ‚Ç¥ (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ)
  function grantVoucherIfPaid(){
    try{
      if (localStorage.getItem(PAID_KEY) !== '1') return; // –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–ª–∞—Ç–∏–ª–∏
      const v = JSON.parse(localStorage.getItem(VOUCHER_KEY)||'null');
      if (v && !v.used && Number(v.amount) >= 25) return; // —É–∂–µ –µ—Å—Ç—å
      const payload = { amount:25, currency:'UAH', sourceTripId: TRIP_ID, createdAt: Date.now(), used:false };
      localStorage.setItem(VOUCHER_KEY, JSON.stringify(payload));
      renderVoucherBanner();
    }catch{}
  }

  function updateStatus(newStatus){
    state.status = newStatus;
    localStorage.setItem(STORE_KEY, JSON.stringify(state));
    if (newStatus === 'confirmed'){
      location.href = `trip-live.html?tripId=${encodeURIComponent(TRIP_ID)}&status=confirmed`;
      return;
    }
    if (newStatus === 'cancelled'){
      // –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –æ–ø–ª–∞—á–µ–Ω–Ω—ã–π —Å–±–æ—Ä –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –±—Ä–æ–Ω—å
      grantVoucherIfPaid();

      noticeTitle.textContent = '‚ùå –û—Ç–º–µ–Ω–µ–Ω–∞';
      noticeText.textContent  = '–í–æ–¥–∏—Ç–µ–ª—å –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞. –ë—Ä–æ–Ω—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–µ–Ω–∞.';
      document.querySelector('.meter').style.display = 'none';
      timeLeftEl.parentElement.style.display = 'none';
    }
  }

  function tick(){
    if (state.status !== 'pending') return;
    const left = state.createdAt + DEADLINE_MS - Date.now();
    if (left <= 0){ updateStatus('cancelled'); return; }
    const m = Math.floor(left/60000);
    const s = Math.floor((left%60000)/1000);
    timeLeftEl.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    meterFill.style.width = ((1 - left/DEADLINE_MS)*100).toFixed(1)+'%';
  }
  tick(); setInterval(tick, 1000);

  // —Ä—É—á–Ω–∞—è –æ—Ç–º–µ–Ω–∞
  document.getElementById('cancelBooking').addEventListener('click', ()=>{
    if (!confirm('–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å? –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–±–æ—Ä –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è.')) return;
    // –ø–µ—Ä–µ–Ω–æ—Å–∏–º 25 ‚Ç¥ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –±—Ä–æ–Ω—å
    grantVoucherIfPaid();

    localStorage.removeItem(STORE_KEY);
    localStorage.removeItem('activeBooking'); // –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
    updateStatus('cancelled');
  });

  // –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–º—ë—Ç ¬´–ò—Å–∫–∞—Ç—å –¥—Ä—É–≥—É—é¬ª ‚Äî —Ç–æ–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞—É—á–µ—Ä
  document.getElementById('searchCta').addEventListener('click', ()=>{
    grantVoucherIfPaid();
  }, {passive:true});

  // (–∑–∞–≥–ª—É—à–∫–∞) –ø–æ–ª–ª–∏–Ω–≥ –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
  async function poll(){
    if (state.status !== 'pending') return;
    // —Ç—É—Ç –ø–æ–¥–∫–ª—é—á–∏—à—å API; –µ—Å–ª–∏ –ø–æ–ª—É—á–∏—à—å confirmed ‚Äî –≤—ã–∑–æ–≤–∏ updateStatus('confirmed')
    setTimeout(poll, 15000);
  }
  poll();
</script>
</body>
</html>
